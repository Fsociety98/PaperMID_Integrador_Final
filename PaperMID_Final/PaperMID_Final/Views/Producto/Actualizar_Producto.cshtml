@model PaperMID.BO.ProductoBO
@{
    ViewBag.Title = "Actualizar_Producto";
    Layout = "~/Views/Master/_LayoutAdministrador.cshtml";
}
<div class="ajax-content container-fluid">
    <section class="content-header">
        <h1>
            Productos
        </h1>
    </section>
    <section class="content container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="box box-primary">
                    <div class="box-header with-border">
                        <h3 class="box-title">Datos</h3>
                    </div>
                    @using (Ajax.BeginForm("Actualizar_Datos_Producto", "Producto", new AjaxOptions { HttpMethod = "POST" }))
                    {
                        @Html.AntiForgeryToken()

                        <form role="form">
                            <div class="box-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label>Código Producto</label>
                                            <div class="input-group">
                                                <div class="input-group-addon">
                                                    <i class="fa fa-tag"></i>
                                                </div>
                                                <input type="text" placeholder="Código Producto" class="form-control" name="CódigoProd" value="@Model.CódigoProd" required />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="form-group">
                                            <label>Nombre Producto</label>
                                            <div class="input-group">
                                                <div class="input-group-addon">
                                                    <i class="fa fa-shopping-cart"></i>
                                                </div>
                                                <input type="text" placeholder="Nombre Producto" class="form-control" name="NombreProd" value="@Model.NombreProd" required />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            <label>Descripcion del Producto</label>
                                            <textarea class="form-control" placeholder="Escribe aquí la descripción del producto" rows="5" style="width: 100%; height: 87px;" name="DescripcionProd" required>@Model.DescripcionProd</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="box-header with-border">
                                    <h3 class="box-title">Detalles de Stock</h3>
                                </div>
                                <div class="row">
                                    <div class="col-md-8">
                                        <br /><br />
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group ">
                                                    <label>Precio Producto</label>
                                                    <div class="input-group">
                                                        <div class="input-group-addon">
                                                            $
                                                        </div>
                                                        <input type="number" placeholder="Precio Producto" class="form-control" name="PrecioProd" value="@Model.PrecioProd" required />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group ">
                                                    <label>Descuento Producto</label>
                                                    <div class="input-group">
                                                        <div class="input-group-addon">
                                                            $
                                                        </div>
                                                        <input type="number" placeholder="Descuento Producto" class="form-control" name="DescuentoProd" value="@Model.DescuentoProd" required />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group ">
                                                    <label>Cantidad Disponible</label>
                                                    <div class="input-group">
                                                        <div class="input-group-addon">
                                                            <i class="fa  fa-th-list"></i>
                                                        </div>
                                                        <input type="number" placeholder="Cantidad Disponible" class="form-control" name="CantidadDisponibleProd" value="@Model.CantidadDisponibleProd" required />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group ">
                                                    <label>Cantidad Mínima</label>
                                                    <div class="input-group">
                                                        <div class="input-group-addon">
                                                            <i class="fa  fa-th-list"></i>
                                                        </div>
                                                        <input type="number" placeholder="Cantidad Mínima" class="form-control" name="CantidadMinimaProd" value="@Model.CantidadMinimaProd" required />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label>Tipo Producto</label><!--Obtener el valor del DropDownList por AJAX-->
                                                    @Html.DropDownList("IdProveedor1", null, htmlAttributes: new { @class = "form-control select2", @style = "width: 100%;" })
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label>Tipo Producto</label><!--Obtener el valor del DropDownList por AJAX-->
                                                    @Html.DropDownList("IdTipoProducto1", null, htmlAttributes: new { @class = "form-control select2", @style = "width: 100%;" })
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br />
                                    <div class="col-md-4">
                                        <div style="text-align:center; border:1px solid rgb(204, 204, 204);">
                                            <output id="ContenedorImg">
                                                @*Elemento dondé se cargará la nueva imagen #3c8dbc*@
                                                @if (Model.Foto!=null)
                                                {
                                                    String Photo = "data:image/jpeg;base64," + Convert.ToBase64String((byte[])Model.Foto);
                                                    <img src="@Photo" class="PreviewImagen">
                                                }
                                            </output>
                                            <br />
                                        </div>
                                        <br />
                                        <div class="file-loading">
                                            <input type="file" id="files" name="ImagenProducto" value="@Model.Foto" required />
                                        </div>
                                        <br />
                                    </div>
                                </div>
                            </div>
                            <!-- /.box-body -->
                            <div class="box-footer">
                                <button type="submit" class="btn btn-info pull-right">Editar</button>
                            </div>
                        </form>
                    }

                </div>
            </div>
        </div>
    </section>
</div>

    <style>
        .PreviewImagen {
            height: 200px;
            width: 200px;
            margin: 10px 5px 0 0;
        }
    </style>@*CSS para la Preview de la imagen*@

    <script type="text/javascript">
        function archivo(evt) {
            var files = evt.target.files; // FileList object
            // Obtenemos la imagen del campo "file".
            for (var i = 0, f; f = files[i]; i++) {
                //Solo admitimos imágenes.
                if (!f.type.match('image.*')) { continue; }

                var reader = new FileReader();

                reader.onload = (function (theFile) {
                    return function (e) {
                        // Insertamos la imagen
                        document.getElementById("ContenedorImg").innerHTML = ['<img class="PreviewImagen" src="', e.target.result, '" title="', escape(theFile.name), '"/>'].join('');
                    };
                })(f);


                reader.readAsDataURL(f);
            }
        }

        document.getElementById('files').addEventListener('change', archivo, false);
    </script> @*Script para la Preview de la imagen*@
